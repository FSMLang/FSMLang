/**
	sub_machine2.c

	This file automatically generated by FSMLang
*/

#include "sub_machine2_priv.h"
#include <stddef.h>


#ifndef DBG_PRINTF
#define DBG_PRINTF(...)
#endif

static TOP_LEVEL_EVENT sub_machine2FSM(pSUB_MACHINE2,TOP_LEVEL_EVENT);

static void * const sub_machine2_INSTANCES[top_level_numInstances];
static TOP_LEVEL_EVENT s1_stateFn(pSUB_MACHINE2,TOP_LEVEL_EVENT);
static TOP_LEVEL_EVENT s2_stateFn(pSUB_MACHINE2,TOP_LEVEL_EVENT);
static TOP_LEVEL_EVENT s3_stateFn(pSUB_MACHINE2,TOP_LEVEL_EVENT);

static const SUB_MACHINE2_STATE_FN sub_machine2_state_fn_array[sub_machine2_numStates] = 
{
	  s1_stateFn
	, s2_stateFn
	, s3_stateFn
};


TOP_LEVEL_EVENT THIS(sub_machine_fn)(const void *pfsm, TOP_LEVEL_EVENT e)
{
	return ((FSM_TYPE_PTR)pfsm)->fsm((FSM_TYPE_PTR)pfsm,e);
}

TOP_LEVEL_SUB_FSM_IF top_level_sub_machine2_sub_fsm_if =
{
	  .subFSM = THIS(sub_machine_fn)
	, .instanceArray = &sub_machine2_INSTANCES
	, .first_event = THIS(firstEvent)
	, .last_event = THIS(noEvent)
};

static SUB_MACHINE2 sub_machine2_INSTANCE0 = {
	.state = sub_machine2_s1
	, .event = THIS(e1)
	, .statesArray = &sub_machine2_state_fn_array
	, .instance = 0
	, .fsm = sub_machine2FSM
	};
static void * const sub_machine2_INSTANCES[top_level_numInstances] = {
	  &sub_machine2_INSTANCE0
};

#ifndef EVENT_IS_NOT_EXCLUDED_FROM_LOG
#define EVENT_IS_NOT_EXCLUDED_FROM_LOG(e) (e == e)
#endif
static TOP_LEVEL_EVENT sub_machine2FSM(pSUB_MACHINE2 pfsm, TOP_LEVEL_EVENT event)
{
	TOP_LEVEL_EVENT e = event;

	while ((e != THIS(noEvent))
	       && (e >= THIS(firstEvent))
	      )
	{

#ifdef TOP_LEVEL_SUB_MACHINE2_DEBUG
if ((EVENT_IS_NOT_EXCLUDED_FROM_LOG(e))
    && (e >= THIS(firstEvent))
    && (e < THIS(noEvent))
   )
{
	DBG_PRINTF("event: %s; state: %s"
,SUB_MACHINE2_EVENT_NAMES[e - THIS(firstEvent)]
,SUB_MACHINE2_STATE_NAMES[pfsm->state]
);
}
#endif

		/* This is read-only data to facilitate error reporting in action functions */
		pfsm->event = e;

		if ((e >= THIS(firstEvent))
		    && (e < THIS(noEvent))
			)
		{
		e = ((* (*pfsm->statesArray)[pfsm->state])(pfsm,e));
		}

	}

	return e == THIS(noEvent) ? PARENT(noEvent) : e;
}

static TOP_LEVEL_EVENT s1_stateFn(pSUB_MACHINE2 pfsm,TOP_LEVEL_EVENT e)
{
	TOP_LEVEL_EVENT retVal = THIS(noEvent);

	switch(e)
	{
	case THIS(e1):
		retVal = UFMN(a1)(pfsm);
		pfsm->state = sub_machine2_s2;
		break;
	default:
		DBG_PRINTF("sub_machine2_noAction");
		break;
	}

	return retVal;
}

static TOP_LEVEL_EVENT s2_stateFn(pSUB_MACHINE2 pfsm,TOP_LEVEL_EVENT e)
{
	TOP_LEVEL_EVENT retVal = THIS(noEvent);

	switch(e)
	{
	case THIS(e2):
		retVal = UFMN(a2)(pfsm);
		pfsm->state = sub_machine2_s3;
		break;
	default:
		DBG_PRINTF("sub_machine2_noAction");
		break;
	}

	return retVal;
}

static TOP_LEVEL_EVENT s3_stateFn(pSUB_MACHINE2 pfsm,TOP_LEVEL_EVENT e)
{
	TOP_LEVEL_EVENT retVal = THIS(noEvent);

	switch(e)
	{
	case THIS(e3):
		retVal = UFMN(a3)(pfsm);
		pfsm->state = sub_machine2_s1;
		break;
	default:
		DBG_PRINTF("sub_machine2_noAction");
		break;
	}

	return retVal;
}


ACTION_RETURN_TYPE __attribute__((weak)) UFMN(a1)(FSM_TYPE_PTR pfsm)
{
	DBG_PRINTF("weak: %s", __func__);
	(void) pfsm;
	return THIS(noEvent);
}

ACTION_RETURN_TYPE __attribute__((weak)) UFMN(a2)(FSM_TYPE_PTR pfsm)
{
	DBG_PRINTF("weak: %s", __func__);
	(void) pfsm;
	return THIS(noEvent);
}

ACTION_RETURN_TYPE __attribute__((weak)) UFMN(a3)(FSM_TYPE_PTR pfsm)
{
	DBG_PRINTF("weak: %s", __func__);
	(void) pfsm;
	return THIS(noEvent);
}


#ifdef TOP_LEVEL_SUB_MACHINE2_DEBUG
char *SUB_MACHINE2_EVENT_NAMES[] = {
	 "sub_machine2_e1"
	,"sub_machine2_e2"
	,"sub_machine2_e3"
	, "sub_machine2_noEvent"
	, "sub_machine2_numEvents"
};

char *SUB_MACHINE2_STATE_NAMES[] = {
	 "sub_machine2_s1"
	,"sub_machine2_s2"
	,"sub_machine2_s3"
};

#endif
